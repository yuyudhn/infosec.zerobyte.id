---
layout: post
title: Memperoleh CVE dari Plugin WordPress (CVE-2021-25118)
categories: [CVE]
author: Fariq Fadillah
---

### Summary

Pada saat mengerjakan proyek yang membutuhkan REST API WordPress sebuah blog, saya menemukan kerentanan di plugin Yoast SEO versi 17.2 dan sudah saya laporkan kepada pihak WordPress. Setelah itu saya diberikan kode CVE-2021-25118. Terkait dengan celah yang saya temukan, versi yang terdampak yaitu versi 16.7 sampai 17.2 dan sudah diperbaiki pada versi 17.3.

### Description

Wordpress Plugin Yoast Seo versi 16.7 - 17.2 terdapat celah Information Disclosure tepatnya menampilkan Full Internal Path dari featured images sebuah post melalui REST API `/wp/v2/posts`. Full Internal Path dapat membantu penyerang untuk dikombinasikan dengan eksploitasi kerentanan lain yang teridentifikasi.

### Step to Reproduce

Pada sebuah post harus ada featured image agar bisa menampilkan Full Internal Path.
Untuk melakukan eksploitasi bisa menggunakan bantuan cURL dan jq.

```
curl -s 'https://example.com/wp-json/wp/v2/posts?per_page=1' | jq '.[0].yoast_head_json.og_image[0].path' 
```

<img src="https://infosec.zerobyte.id/images/CVE-2021-25118-poc.png" alt="POC CVE-2021-25118">

### Conclusion

Setelah itu saya mengirim report ke [WPScan](https://wpscan.com/submit) agar dibantu untuk diberi kode CVE dan beberapa hari kemudian pihak WPScan memberi kode CVE-2021-25118.

<img src="https://infosec.zerobyte.id/images/CVE-2021-25118-assigned.png" alt="CVE-2021-25118 Assigned">

Bug Fix pada [versi 17.3](https://plugins.trac.wordpress.org/changeset/2608691).

File: `src/presenters/open-graph/image-presenter.php`
<img src="https://infosec.zerobyte.id/images/CVE-2021-25118-fix.png" alt="CVE-2021-25118 fixed">

Terima kasih dan mohon maaf jika ada kesalahan.
